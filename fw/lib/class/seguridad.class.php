<?phpclass Seguridad {	CONST lONGITUD_ID_USUARIO = 8;	CONST LONGITUD_CLAVE = 6;	CONST LONGITUD_TRANSACCION = 10;	CONST CLAVE_ENCRIPCION = '55303f40d1456b0023ac6f6ded67977b35382663';	//M0SS4PpByW1SGrOUP+VethaSWH0us3	private $db;	private $ruta_cron = '';	function __construct($db, $ruta_cron = '') {		$this->db = $db;		$this->ruta_cron = $ruta_cron;	}	function generar_nuevo_login() {		$nuevo_usuario_id = "";		$sql_select = $this->db->selectOne(array('id_usuario'), 'usuario_id');		$usuario_id = $sql_select['id_usuario'] + 1;		$sql_update = $this->db->update(array('id_usuario' => $usuario_id), 'usuario_id');		if (strlen($usuario_id) < self::lONGITUD_ID_USUARIO) {			// $limit = self::lONGITUD_ID_USUARIO - strlen($usuario_id);			// echo $limit;			$nuevo_usuario_id = str_pad($usuario_id, self::lONGITUD_ID_USUARIO, '0', STR_PAD_LEFT);			// echo $nuevo_usuario_id;   		}		return $nuevo_usuario_id;	}	function generar_nueva_clave() {		$clave = "";		for ($i = 0; $i < self::LONGITUD_CLAVE; $i++) {			$clave.= rand(0, 9);		}		return $clave;	}	function encriptar_clave($clave) {		$string = $clave . self::CLAVE_ENCRIPCION;		$clave_encriptada = sha1($string);		return $clave_encriptada;	}	/* ------------- Reestructurar Funciones ---------- */	function getIp($codigo = NULL) {		$usuario_ingresos = array();		if ($codigo == NULL){			$usuario = $this->getDataLoged('codigo');		}else{			$usuario = $codigo;		}		$sql = "SELECT login, ip, fecha_ingreso            FROM usuario_ingresos            WHERE login='$usuario'            ORDER BY fecha_ingreso            DESC limit 5";		$result = mysql_query($sql);		if ($result) {			while ($row = mysql_fetch_object($result)) {				$usuario_ingresos[] = $row;			}		}		return $usuario_ingresos;	}	function keyEncrypt($dato) {		$string = $dato . $this->key;		$encrypt = sha1($string);		return $encrypt;	}	function setEncrypt($dato, $nombre) {		$string = $dato . $this->key;		//$_SESSION['param_encrypt_'.$nombre] = md5($string);	}}